<p>create table custom_user(</p>

<p>user_id varchar(5),<br>
date_of_purchase DATE NOT NULL DEFAULT CURRENT_DATE,<br>
product char(30),<br>
amount_paid varchar(5)<br>
);</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>create table custom_user(</p>

<p>user_id varchar(5),<br>
city char(30),</p>

<p>age char(3),</p>

<p>date_of_registration varchar(10)</p>

<p>);</p>

<p>&nbsp;</p>

<p>copy Public."custom_user" from 'C:\Users\Sakthi\PycharmProjects\MyProject\MyFolder\MY_NIFI_folder\user_purchase_details\user_purchase_details.csv' DELIMITER ',' CSV HEADER</p>

<p>INSERT INTO FlowFiles (user_id, date_of_purchase, product, amont_paid)<br>
VALUES ('${user_id}', '${date_of_purchase}', '${product}', '${amount_paid}')</p>

<p>&nbsp;</p>

<h2><strong>with only where clause :</strong></h2>

<p>select cu.user_id, cu.city, up.product, DATE_TRUNC('month', to_DATE(up.date_of_purchase,'YYYY/MM/DD')) &nbsp;<br>
from custom_user cu, user_purchase up&nbsp;<br>
where cu.user_id = up.user_id<br>
group by cu.user_id, cu.city, up.product, DATE_TRUNC('month', to_DATE(up.date_of_purchase,'YYYY/MM/DD'))<br>
order by DATE_TRUNC('month', to_DATE(up.date_of_purchase,'YYYY/MM/DD'))<br>
&nbsp;</p>

<h2>&nbsp;</h2>

<h2><strong>with&nbsp; inner join :&nbsp;</strong></h2>

<p>select cu.user_id, cu.city, up.product, DATE_TRUNC('month', to_DATE(up.date_of_purchase,'YYYY/MM/DD')) &nbsp;<br>
from custom_user cu inner join user_purchase up&nbsp;<br>
on cu.user_id = up.user_id<br>
group by cu.user_id, cu.city, up.product, DATE_TRUNC('month', to_DATE(up.date_of_purchase,'YYYY/MM/DD'))<br>
order by DATE_TRUNC('month', to_DATE(up.date_of_purchase,'YYYY/MM/DD'))<br>
&nbsp;</p>

<h2><strong>result_table :&nbsp;</strong></h2>

<p>create table result_table(<br>
&nbsp;&nbsp; &nbsp;user_id varchar(3),<br>
&nbsp;&nbsp; &nbsp;city char(30),<br>
&nbsp;&nbsp; &nbsp;product char(30),<br>
&nbsp;&nbsp; &nbsp;date_of_purchase varchar(10)<br>
)</p>
